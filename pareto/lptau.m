function f = lptau(i,n)

NR = [
1, 1, 1, 1, 1, 1, 1, 1, 1, 1;
1, 3, 5, 15, 17, 51, 85, 255, 257, 771;
1, 1, 7, 11, 13, 61, 67, 79, 465, 721;
1, 3, 7, 5, 7, 43, 49, 147, 439, 1013;
1, 1, 5, 3, 15, 51, 125, 141, 177, 759;
1, 3, 1, 1, 9, 59, 25, 89, 321, 835;
1, 1, 3, 7, 31, 47, 109, 173, 181, 949; 
1, 3, 3, 9, 9, 57, 43, 43, 225, 113;
];
 a=i;
 m=1+floor(log(a)/0.693147);
 q=zeros(n,1);
 for j=1:n
    s=0;
    for k=1:m
        ns=0;
        for l=k:m
           b = NR(j,l);
           ns = ns + floor(2*D(a/(2^l)))*floor(2*D(b/(2^(l+1-k))));
        end
        s = s + D(0.5*ns)/(2^(k-1));
    end
    q(j) = s;
    
 end
 f = q;
 
end